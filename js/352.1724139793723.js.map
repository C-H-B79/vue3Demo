{"version":3,"file":"js/352.1724139793723.js","mappings":"mMAAA,MAAMA,EACFC,WAAAA,CAAYC,GACRC,KAAKC,MAAQ,EACbD,KAAKE,SAAWH,EAChBC,KAAKG,MAAQ,IAAIC,KACrB,CACA,SAAMC,CAAIC,GACFN,KAAKC,OAASD,KAAKE,gBACb,IAAIK,SAAQ,CAACC,EAASC,KACxBT,KAAKG,MAAMO,KAAKF,EAAQ,IAGhCR,KAAKC,QACL,MAAMU,QAAeL,IAKrB,OAJAN,KAAKC,QACDD,KAAKG,MAAMS,OAAS,GACpBZ,KAAKG,MAAMU,OAAXb,GAEGW,CACX,EAEJ,QCrBO,SAASG,EAAcC,GAC1B,IAAIC,EAAO,IAAIC,KAAKF,GAChBG,EAAOF,EAAKG,cACZC,EAAQJ,EAAKK,WAAa,EAC9BD,EAAQE,OAAOF,GAAOG,SAAS,EAAG,KAClC,IAAIC,EAAMR,EAAKS,UACfD,EAAMF,OAAOE,GAAKD,SAAS,EAAG,KAC9B,IAAIG,EAAOV,EAAKW,WAChBD,EAAOJ,OAAOI,GAAMH,SAAS,EAAG,KAChC,IAAIK,EAASZ,EAAKa,aAClBD,EAASN,OAAOM,GAAQL,SAAS,EAAG,KACpC,IAAIO,EAASd,EAAKe,aAClBD,EAASR,OAAOQ,GAAQP,SAAS,EAAG,KACpC,IAAIS,EAAUd,EAAO,IAAME,EAAQ,IAAMI,EAAM,IAAME,EAAO,IAAME,EAAS,IAAME,EACjF,MAAO,CACHZ,OACAE,QACAI,MACAE,OACAE,SACAE,SACAE,UAGR,C,4LCVA,IAAIC,GAAYC,EAAAA,EAAAA,MAChB,MAAMC,GAAQD,EAAAA,EAAAA,IAAI,KAClBE,EAAAA,EAAAA,KAAU,KACRH,EAAY,IAAIpC,EAAU,GAC1BwC,GAAS,IAEX,MAAMA,EAAUA,KACdC,QAAQC,IAAIN,GACZO,EAAQ,IAAM,GACdA,EAAQ,IAAM,GACdA,EAAQ,IAAM,GACdA,EAAQ,IAAM,GACdA,EAAQ,IAAM,GACdA,EAAQ,IAAM,EAAE,EAEZA,EAAUA,CAACzB,EAAM0B,KACrBR,EACG5B,KAAI,IAAMqC,EAAQ3B,KAClB4B,MAAK,KACJ,IAAIC,EAAM,CACRH,MAAOA,EACP1B,MAAM,IAAIE,MAAO4B,WAEnBV,EAAMW,MAAMpC,KAAKkC,GACjBN,QAAQC,IAAIE,GACZH,QAAQC,KAAI,IAAItB,MAAO4B,UAAU,GACjC,EAEAH,EAAW3B,GACR,IAAIR,SAAQ,CAACC,EAASC,KAC3BsC,WAAWvC,EAASO,EAAK,IAGvBiC,EAAcjC,GACXD,EAAcC,GAAMiB,Q,uPC1C7B,MAAMiB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://vue3-demo/./src/views/queueWait/index.js","webpack://vue3-demo/./src/utils/date.js","webpack://vue3-demo/./src/views/queueWait/index.vue","webpack://vue3-demo/./src/views/queueWait/index.vue?eaa9"],"sourcesContent":["class Scheduler {\r\n    constructor(max) {\r\n        this.count = 0\r\n        this.maxCount = max\r\n        this.queue = new Array()\r\n    }\r\n    async add(promiseCreator) {\r\n        if (this.count >= this.maxCount) {\r\n            await new Promise((resolve, reject) => {\r\n                this.queue.push(resolve)\r\n            })\r\n        }\r\n        this.count++\r\n        const result = await promiseCreator()\r\n        this.count--\r\n        if (this.queue.length > 0) {\r\n            this.queue.shift()()\r\n        }\r\n        return result\r\n    }\r\n}\r\nexport default Scheduler;","export function dateTransform(time) {\r\n    let date = new Date(time)\r\n    let year = date.getFullYear()\r\n    let month = date.getMonth() + 1\r\n    month = String(month).padStart(2, '0')\r\n    let day = date.getDate()\r\n    day = String(day).padStart(2, '0')\r\n    let hour = date.getHours()\r\n    hour = String(hour).padStart(2, '0')\r\n    let minute = date.getMinutes()\r\n    minute = String(minute).padStart(2, '0')\r\n    let second = date.getSeconds()\r\n    second = String(second).padStart(2, '0')\r\n    let dateStr = year + '-' + month + '-' + day + ' ' + hour + ':' + minute + ':' + second\r\n    return {\r\n        year,\r\n        month,\r\n        day,\r\n        hour,\r\n        minute,\r\n        second,\r\n        dateStr\r\n    }\r\n\r\n}","<template>\r\n  <div class=\"queueWait\">\r\n    <div class=\"queue-result\">\r\n      <div class=\"\">队列结果列表</div>\r\n      <div class=\"\" v-for=\"(item, index) in array\" :key=\"index\">\r\n        {{ item.order }}------------{{ formatTime(item.time) }}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport { onMounted, ref } from \"vue\";\r\nimport Scheduler from \"./index\";\r\nimport { dateTransform } from \"@/utils/date\";\r\nlet scheduler = ref();\r\nconst array = ref([]);\r\nonMounted(() => {\r\n  scheduler = new Scheduler(2);\r\n  execute();\r\n});\r\nconst execute = () => {\r\n  console.log(scheduler);\r\n  addTask(1000, 1);\r\n  addTask(2000, 2);\r\n  addTask(3000, 3);\r\n  addTask(4000, 4);\r\n  addTask(5000, 5);\r\n  addTask(6000, 6);\r\n};\r\nconst addTask = (time, order) => {\r\n  scheduler\r\n    .add(() => timeOut(time))\r\n    .then(() => {\r\n      let obj = {\r\n        order: order,\r\n        time: new Date().getTime(),\r\n      };\r\n      array.value.push(obj);\r\n      console.log(order);\r\n      console.log(new Date().getTime());\r\n    });\r\n};\r\nconst timeOut = (time) => {\r\n  return new Promise((resolve, reject) => {\r\n    setTimeout(resolve, time);\r\n  });\r\n};\r\nconst formatTime = (time) => {\r\n  return dateTransform(time).dateStr;\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.queueWait {\r\n}\r\n</style>","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=04555684&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-04555684\"]])\n\nexport default __exports__"],"names":["Scheduler","constructor","max","this","count","maxCount","queue","Array","add","promiseCreator","Promise","resolve","reject","push","result","length","shift","dateTransform","time","date","Date","year","getFullYear","month","getMonth","String","padStart","day","getDate","hour","getHours","minute","getMinutes","second","getSeconds","dateStr","scheduler","ref","array","onMounted","execute","console","log","addTask","order","timeOut","then","obj","getTime","value","setTimeout","formatTime","__exports__"],"sourceRoot":""}